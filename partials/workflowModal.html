<style>
    .workflow-stages .current {
        font-weight: bold;
    }
    .workflow-stages .complete {
        color: green
    }
    .workflow-stages .incomplete {
        color: yellow
    }
    .workflow-stages .unavailable {
        color: gray
    }
</style>

<div class="modal-container" unfocus-modal>
    <div class="modal huge-modal">
        <div class="close-modal" ng-click="cancel()"></div>

        <div class="modal-content" ng-if="!moduleName">
            <h2>Select Module</h2>

            <div class="tiles">
                <div class="tile" ng-repeat="module in modules" ng-click="selectModule(module)">
                    <img ng-src="{{::module.image}}"/>
                    <span>{{::module.label}}</span>
                </div>
            </div>
        </div>

        <div class="modal-content" ng-if="moduleName && !workflowName">
            <h2>Select Workflow</h2>

            <div class="tiles">
                <div class="tile" ng-repeat="workflow in workflows" ng-click="selectWorkflow(workflow)">
                    <img ng-src="{{::workflow.image}}"/>
                    <span>{{::workflow.label}}</span>
                </div>
            </div>
        </div>

        <div class="modal-content" ng-if="workflowName">
            <div class="workflow-stages">
                <h2>{{::module.label}} - {{::workflow.label}}</h2>
                <div ng-repeat="stageRoadmapEntry in stageRoadmap">
                    <a ng-show="stageRoadmapEntry.stage.name !== currentStageName && stageRoadmapEntry.isAvailable()"
                       ng-click="setStage(stageRoadmapEntry.stage)"
                       ng-class="{
                           'complete': stageRoadmapEntry.isComplete(),
                           'incomplete': stageRoadmapEntry.isIncomplete()
                        }">
                       {{::stageRoadmapEntry.stage.name}}
                    </a>
                    <span ng-show="stageRoadmapEntry.stage.name === currentStageName || !stageRoadmapEntry.isAvailable()"
                          ng-class="{
                              'current': stageRoadmapEntry.stage.name === currentStageName,
                              'complete': stageRoadmapEntry.isComplete(),
                              'incomplete': stageRoadmapEntry.isIncomplete(),
                              'unavailable': !stageRoadmapEntry.isAvailable()
                            }">
                       {{::stageRoadmapEntry.stage.name}}
                    </span>
                </div>
            </div>
            <div class="workflow-content">
                <div ng-include="view.templateUrl" dyn-controller="view.controller"></div>
                <div class="stage-buttons">
                    <button class="prev-button" ng-click="previousStage()" ng-disabled="!canNavigatePrevious">
                        Previous
                    </button>
                    <button class="next-button" ng-click="nextStage()" ng-disabled="!canNavigateNext">
                        Next
                    </button>
                    <button ng-show="canFinishWorkflow" class="finish-button" ng-click="finish()">
                        Finish
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
